<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前言 | 此间少年</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/BlogSite/icon.jpeg">
    <meta name="description" content="我的个人博客">
    
    <link rel="preload" href="/BlogSite/assets/css/0.styles.a8333bdb.css" as="style"><link rel="preload" href="/BlogSite/assets/js/app.91af3156.js" as="script"><link rel="preload" href="/BlogSite/assets/js/2.b901c437.js" as="script"><link rel="preload" href="/BlogSite/assets/js/7.56326d4d.js" as="script"><link rel="prefetch" href="/BlogSite/assets/js/10.77e2142e.js"><link rel="prefetch" href="/BlogSite/assets/js/11.88770c6a.js"><link rel="prefetch" href="/BlogSite/assets/js/12.6553d92f.js"><link rel="prefetch" href="/BlogSite/assets/js/13.8e0167b6.js"><link rel="prefetch" href="/BlogSite/assets/js/14.32570529.js"><link rel="prefetch" href="/BlogSite/assets/js/15.0486ad24.js"><link rel="prefetch" href="/BlogSite/assets/js/16.629087e6.js"><link rel="prefetch" href="/BlogSite/assets/js/17.3caf61bb.js"><link rel="prefetch" href="/BlogSite/assets/js/18.03914526.js"><link rel="prefetch" href="/BlogSite/assets/js/19.e395d49f.js"><link rel="prefetch" href="/BlogSite/assets/js/20.ea45d2a5.js"><link rel="prefetch" href="/BlogSite/assets/js/21.ff04b26b.js"><link rel="prefetch" href="/BlogSite/assets/js/22.3783a228.js"><link rel="prefetch" href="/BlogSite/assets/js/23.ed0758a0.js"><link rel="prefetch" href="/BlogSite/assets/js/24.f0f5b32d.js"><link rel="prefetch" href="/BlogSite/assets/js/25.49bf9a9e.js"><link rel="prefetch" href="/BlogSite/assets/js/26.a0c26f33.js"><link rel="prefetch" href="/BlogSite/assets/js/27.115a3924.js"><link rel="prefetch" href="/BlogSite/assets/js/28.65cecc22.js"><link rel="prefetch" href="/BlogSite/assets/js/29.2972613b.js"><link rel="prefetch" href="/BlogSite/assets/js/3.2e87878e.js"><link rel="prefetch" href="/BlogSite/assets/js/30.edf4a4c5.js"><link rel="prefetch" href="/BlogSite/assets/js/31.91b9dc02.js"><link rel="prefetch" href="/BlogSite/assets/js/32.4083088e.js"><link rel="prefetch" href="/BlogSite/assets/js/33.6fddb947.js"><link rel="prefetch" href="/BlogSite/assets/js/34.e5c00390.js"><link rel="prefetch" href="/BlogSite/assets/js/35.86123817.js"><link rel="prefetch" href="/BlogSite/assets/js/36.ad454a8b.js"><link rel="prefetch" href="/BlogSite/assets/js/37.af7e9aa9.js"><link rel="prefetch" href="/BlogSite/assets/js/38.3cef16ce.js"><link rel="prefetch" href="/BlogSite/assets/js/39.98aa7839.js"><link rel="prefetch" href="/BlogSite/assets/js/4.0875ec02.js"><link rel="prefetch" href="/BlogSite/assets/js/40.a9c81828.js"><link rel="prefetch" href="/BlogSite/assets/js/41.bfa5acbf.js"><link rel="prefetch" href="/BlogSite/assets/js/42.f96ceba5.js"><link rel="prefetch" href="/BlogSite/assets/js/43.9a6e001d.js"><link rel="prefetch" href="/BlogSite/assets/js/44.fe647415.js"><link rel="prefetch" href="/BlogSite/assets/js/45.076139ee.js"><link rel="prefetch" href="/BlogSite/assets/js/46.9c5ecfc6.js"><link rel="prefetch" href="/BlogSite/assets/js/47.abfd9bd8.js"><link rel="prefetch" href="/BlogSite/assets/js/48.6584ee87.js"><link rel="prefetch" href="/BlogSite/assets/js/49.421e1473.js"><link rel="prefetch" href="/BlogSite/assets/js/5.6fd216fd.js"><link rel="prefetch" href="/BlogSite/assets/js/6.f61242e8.js"><link rel="prefetch" href="/BlogSite/assets/js/8.104c19cf.js"><link rel="prefetch" href="/BlogSite/assets/js/9.dddb2888.js">
    <link rel="stylesheet" href="/BlogSite/assets/css/0.styles.a8333bdb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/BlogSite/" class="home-link router-link-active"><!----> <span class="site-name">此间少年</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端三剑客" class="dropdown-title"><span class="title">前端三剑客</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端三剑客" class="mobile-dropdown-title"><span class="title">前端三剑客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/javascript/prototype/" class="nav-link">
  JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/BlogSite/http/" class="nav-link">
  HTTP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端框架" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/vue/" class="nav-link">
  vue2.0
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/vueNext/" class="nav-link">
  vue3.0
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/react/" class="nav-link">
  React源码分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/rollup/" class="nav-link">
  rollup
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/vite/" class="nav-link router-link-active">
  vite
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试分享" class="dropdown-title"><span class="title">面试分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试分享" class="mobile-dropdown-title"><span class="title">面试分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/interviewQuestion/html/" class="nav-link">
  面试八股文
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/interviewCompany/company1/" class="nav-link">
  面试记录
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端三剑客" class="dropdown-title"><span class="title">前端三剑客</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端三剑客" class="mobile-dropdown-title"><span class="title">前端三剑客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/javascript/prototype/" class="nav-link">
  JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/BlogSite/http/" class="nav-link">
  HTTP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端框架" class="mobile-dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/vue/" class="nav-link">
  vue2.0
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/vueNext/" class="nav-link">
  vue3.0
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/react/" class="nav-link">
  React源码分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/rollup/" class="nav-link">
  rollup
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/vite/" class="nav-link router-link-active">
  vite
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试分享" class="dropdown-title"><span class="title">面试分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试分享" class="mobile-dropdown-title"><span class="title">面试分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlogSite/interviewQuestion/html/" class="nav-link">
  面试八股文
</a></li><li class="dropdown-item"><!----> <a href="/BlogSite/interviewCompany/company1/" class="nav-link">
  面试记录
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/BlogSite/vite/" aria-current="page" class="sidebar-link">前言</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/BlogSite/vite/base/create-project/" class="sidebar-heading clickable open"><span>Vite 基础入门</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/BlogSite/vite/base/create-project/" class="sidebar-link">使用 Vite 快速搭建项目</a></li><li><a href="/BlogSite/vite/base/vite-config/" class="sidebar-link">Vite 配置项介绍</a></li><li><a href="/BlogSite/vite/base/vite-style/" aria-current="page" class="active sidebar-link">Vite 中接入现代化的 CSS 工程方案</a></li></ul></section></li><li><a href="/BlogSite/vite/analysis/" class="sidebar-link">Vite 原理分析</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>本文我们将介绍如何在 Vite 中接入现代化 CSS 解决方案。</p> <h2 id="css-预处理器"><a href="#css-预处理器" class="header-anchor">#</a> CSS 预处理器</h2> <h3 id="_1-使用-sass"><a href="#_1-使用-sass" class="header-anchor">#</a> 1. 使用 sass</h3> <p>Vite 默认对 Sass、Less、Stylus 预处理器做了支持，所以说我们无需配置就可以直接使用。不过，在使用之前我们需要先安装一下对应依赖。这里我们以 sass 为例：</p> <p>首先使用 npm 安装 sass：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> sass <span class="token parameter variable">-D</span>
</code></pre></div><p>接下来，我们把 <code>App.css</code> 文件后缀名改为 <code>.scss</code>，并修改 <code>App.tsx</code> 中的引入路径，启动项目可以发现页面正常显示。</p> <p>修改 <code>App.scss</code> 文件中的代码，加入一些 <code>scss</code> 特性：</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token property"><span class="token variable">$wrap-width</span></span><span class="token punctuation">:</span> 1280px<span class="token punctuation">;</span>

<span class="token selector">#root </span><span class="token punctuation">{</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token variable">$wrap-width</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 2rem<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>

  <span class="token selector">.logo </span><span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 6em<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 1.5em<span class="token punctuation">;</span>
    <span class="token property">will-change</span><span class="token punctuation">:</span> filter<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以发现 CSS 被正确解析来。</p> <p><img src="/BlogSite/assets/img/vite-style-1.6110e68f.jpg" alt=""></p> <h3 id="_2-配置全局-scss-变量"><a href="#_2-配置全局-scss-变量" class="header-anchor">#</a> 2. 配置全局 Scss 变量</h3> <p>接下来，我们创建 <code>styles</code> 文件夹，并在文件夹下创建 <code>variable.scss</code></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token property"><span class="token variable">$theme-color</span></span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
</code></pre></div><p>在 <code>App.scss</code> 中引入 <code>variable.scss</code></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token keyword">@import</span> <span class="token string">&quot;@/styles/variable.scss&quot;</span><span class="token punctuation">;</span>

<span class="token property"><span class="token variable">$wrap-width</span></span><span class="token punctuation">:</span> 1280px<span class="token punctuation">;</span>

<span class="token selector">#root </span><span class="token punctuation">{</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token variable">$wrap-width</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 2rem<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>

  <span class="token selector">.logo </span><span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 6em<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 1.5em<span class="token punctuation">;</span>
    <span class="token property">will-change</span><span class="token punctuation">:</span> filter<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">h1</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$theme-color</span><span class="token punctuation">;</span> <span class="token comment">// 此处使用 variable 中定义的变量</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/BlogSite/assets/img/vite-style-2.541fe3f5.jpg" alt=""></p> <p>但是， <code>variable.scss</code> 中的变量会在很多样式文件中被使用，如果每次使用都需要引入一遍会显得很繁琐，Vite 给我们提供了自动引入的方案。接下来，我们对 Vite 配置进行修改：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig<span class="token punctuation">,</span> normalizePath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> react <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-react'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> path <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> resolve <span class="token operator">=</span> path<span class="token punctuation">.</span>resolve

<span class="token comment">// 全局 scss 文件路径</span>
<span class="token comment">// 用 normalizePath 解决 window 下的路径问题</span>
<span class="token keyword">const</span> variableScssPath <span class="token operator">=</span> <span class="token function">normalizePath</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/styles/variable.scss'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">react</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'@'</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">preprocessorOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">scss</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// additionalData 的内容会在每个 scss 文件的开头自动注入</span>
        <span class="token literal-property property">additionalData</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">@import &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>variableScssPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;;</span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>现在，我们可以把 <code>App.scss</code> 中的 <code>@import &quot;@/styles/variable.scss&quot;;</code> 语句删掉，再次刷新页面，依然可以正确渲染。</p> <h2 id="css-module"><a href="#css-module" class="header-anchor">#</a> CSS Module</h2> <p>CSS Module 在 Vite 中也是可以直接使用的，Vite 会对后缀带有 <code>.module</code> 的样式文件自动应用 <code>CSS Module</code>。接下来我们一起来看一个简单的例子。</p> <p>首先，我们创建一个组件文件夹 <code>components</code>，并创建组件 <code>header</code>，在 <code>header</code> 中 创建 <code>index.module.scss</code>。</p> <div class="language-text extra-class"><pre class="language-text"><code>- components
|    - header
|       - index.tsx
|       - index.module.scss
</code></pre></div><div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">// index.module.scss</span>
<span class="token selector">.header </span><span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在 index.tsx 中我们引用 <code>index.module.scss</code></p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> style <span class="token keyword">from</span> <span class="token string">'./index.module.scss'</span>

<span class="token keyword">export</span>  <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>style<span class="token punctuation">.</span>header<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Vite App</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
</code></pre></div><p>打开页面，可以看到标签 <code>div</code> 的类名已经被处理成了哈希值的形式：</p> <p><img src="/BlogSite/assets/img/vite-style-3.007ccc7f.jpg" alt=""></p> <p>我们也可以在 vite.config 中配置 <code>class</code> 生成的规则：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 省略其他配置</span>
  css<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过 generateScopedName 属性来对生成的类名进行自定义</span>
    modules<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 其中，name 表示当前文件名，local 表示类名</span>
      generateScopedName<span class="token operator">:</span> <span class="token string">&quot;[name]__[local]__[hash:base64:5]&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>刷新页面，我们可以发现类名已经根据我们定义的规则生成:</p> <p><img src="/BlogSite/assets/img/vite-style-4.b67f5fff.jpg" alt=""></p> <h2 id="postcss"><a href="#postcss" class="header-anchor">#</a> PostCSS</h2> <p>Vite 自身已经集成 PostCSS，无需再次安装。另外也无需单独创建PostCSS配置文，可以直接在 Vite 配置文件中进行配置。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 省略其他配置</span>
  css<span class="token operator">:</span> <span class="token punctuation">{</span>
    postcss<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 插件数组</span>
      plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>接下来，我们安装一个常用的 PostCSS 插件 <code>autoprefixer</code>:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> autoprefixer <span class="token parameter variable">-D</span>
</code></pre></div><p>这个插件主要用来自动为不同的目标浏览器添加样式前缀，解决的是浏览器兼容性的问题。接下来我们修改一下 Vite 配置文件来接入这个插件:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 省略其他配置</span>
  css<span class="token operator">:</span> <span class="token punctuation">{</span>
    postcss<span class="token operator">:</span> <span class="token punctuation">{</span>
      plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token comment">// autoprefixer 配置参数</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>之后，我们可以看到 <code>css</code> 文件发生来变化，自动加上了样式前缀：</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.index-module__header__A6CAv</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span>#00f<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>30px<span class="token punctuation">;</span>
    <span class="token property">-webkit-text-decoration</span><span class="token punctuation">:</span>dashed<span class="token punctuation">;</span>
    <span class="token property">text-decoration</span><span class="token punctuation">:</span>dashed
<span class="token punctuation">}</span>
</code></pre></div><p>其他常见的 <code>PostCSS</code> 插件：</p> <ul><li><a href="https://github.com/cuth/postcss-pxtorem" target="_blank" rel="noopener noreferrer">postcss-pxtorem<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 用来将 px 转换为 rem 单位，在适配移动端的场景下很常用。</li> <li><a href="https://github.com/csstools/postcss-preset-env" target="_blank" rel="noopener noreferrer">postcss-preset-env<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 通过它，你可以编写最新的 CSS 语法，不用担心兼容性问题。</li> <li><a href="https://github.com/cssnano/cssnano" target="_blank" rel="noopener noreferrer">cssnano<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 主要用来压缩 CSS 代码，跟常规的代码压缩工具不一样，它能做得更加智能，比如提取一些公共样式进行复用、缩短一些常见的属性值等等。</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/BlogSite/vite/base/vite-config/" class="prev">
        Vite 配置项介绍
      </a></span> <span class="next"><a href="/BlogSite/vite/analysis/">
        Vite 原理分析
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/BlogSite/assets/js/app.91af3156.js" defer></script><script src="/BlogSite/assets/js/2.b901c437.js" defer></script><script src="/BlogSite/assets/js/7.56326d4d.js" defer></script>
  </body>
</html>
